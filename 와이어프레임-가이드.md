# 🔍 와이어프레임 모드 가이드

## 개요

와이어프레임 모드는 메쉬의 내부 구조를 시각화하여 정점(Vertex), 엣지(Edge), 삼각형(Triangle)을 확인할 수 있는 디버깅 도구입니다.

## 사용 방법

### 활성화/비활성화
1. 화면 하단의 **🔍 와이어프레임** 버튼 클릭
2. 버튼이 파란색으로 변하면 활성화됨
3. 다시 클릭하면 일반 모드로 복귀

### 단축키 (추후 추가 가능)
- `W` 키: 와이어프레임 토글
- `G` 키: 그리드 토글

## 시각화 요소

### 1. 정점 (Vertex)
- **표시**: 청록색 원 (●)
- **레이블**: `V0`, `V1`, `V2`, ...
- **의미**: 폴리곤을 구성하는 점들

**예시:**
```
V0 ─── V1
│       │
│       │
V3 ─── V2
```

### 2. 삼각형 (Triangle)
- **표시**: 빨간색 선 (─)
- **레이블**: `T0`, `T1`, `T2`, ...
- **의미**: 폴리곤을 렌더링하기 위한 기본 단위

**삼각형 분해 예시:**
```
사각형 → 2개의 삼각형
  V0 ─── V1         V0 ─── V1
  │   ╱   │   →     │ T0╱   │
  │ ╱     │         │ ╱ T1  │
  V3 ─── V2         V3 ─── V2
```

### 3. 외곽선 (Outline)
- **표시**: 검은색 굵은 선
- **의미**: 메쉬의 경계

### 4. 반투명 배경
- **표시**: 원래 메쉬 색상 + 투명도
- **의미**: 전체적인 형태 파악

## 삼각형 분해 알고리즘

### Fan Triangulation
현재 구현된 알고리즘입니다.

**원리:**
1. 첫 번째 정점(V0)을 중심으로 선택
2. V0에서 다른 모든 정점으로 부채꼴 모양으로 삼각형 생성

**장점:**
- 구현이 간단
- 빠른 처리 속도
- 볼록 다각형(Convex Polygon)에 최적

**단점:**
- 오목 다각형(Concave Polygon)에서는 일부 삼각형이 폴리곤 밖으로 나갈 수 있음
- 품질이 최적이 아닐 수 있음

**코드:**
```javascript
triangulate() {
    const triangles = [];
    const v0 = this.vertices[0];
    
    for (let i = 1; i < this.vertices.length - 1; i++) {
        const v1 = this.vertices[i];
        const v2 = this.vertices[i + 1];
        triangles.push([v0, v1, v2]);
    }
    
    return triangles;
}
```

### 더 나은 삼각형 분해 알고리즘 (추후 구현 가능)

#### 1. Ear Clipping
- 오목 다각형도 처리 가능
- 품질이 좋음
- 복잡도: O(n²)

#### 2. Delaunay Triangulation
- 최고 품질의 삼각형
- 각도가 균등하게 분포
- 복잡도: O(n log n)

#### 3. Constrained Delaunay
- 구멍이 있는 폴리곤 처리
- 가장 강력하지만 복잡함

## 콘솔 출력 정보

와이어프레임 모드를 활성화하면 브라우저 콘솔(F12)에 다음 정보가 출력됩니다:

```
=== 메쉬 통계 ===
메쉬 개수: 3
총 정점 수: 450
총 삼각형 수: 1344

메쉬 #0:
  - 정점: 150개
  - 삼각형: 448개
  - 색상: hsl(120, 70%, 60%)

메쉬 #1:
  - 정점: 200개
  - 삼각형: 598개
  - 색상: hsl(45, 70%, 60%)

메쉬 #2:
  - 정점: 100개
  - 삼각형: 298개
  - 색상: hsl(200, 70%, 60%)
```

## 실전 활용 팁

### 1. 메쉬 복잡도 확인
- 정점 수가 너무 많으면 성능 저하 가능
- 나뭇잎: 약 1000개 정점
- 삼각형: 3개 정점

### 2. 절단선 위치 파악
- 와이어프레임으로 정점 분포 확인
- 정점이 많은 곳을 절단하면 더 깔끔한 결과

### 3. 삼각형 품질 검사
- 너무 길쭉한 삼각형은 렌더링 품질 저하
- Fan Triangulation은 중앙이 밀집될 수 있음

### 4. 디버깅
- 절단 후 정점이 제대로 생성되었는지 확인
- 교차점이 정확한 위치에 있는지 검증

## 성능 최적화

### 정점 수 줄이기
복잡한 SVG의 경우 정점이 너무 많을 수 있습니다.

**방법 1: Bezier 세그먼트 수 줄이기**
```javascript
// mesh-cutting.js의 212번 줄
const segments = 10; // ← 5로 줄이면 정점 절반
```

**방법 2: Douglas-Peucker 알고리즘**
폴리곤 단순화 알고리즘으로 비슷한 위치의 정점을 제거합니다.

```javascript
function simplifyPolygon(vertices, tolerance = 1.0) {
    // Douglas-Peucker 구현
    // tolerance가 클수록 더 많은 정점 제거
}
```

## 색상 코드

| 요소 | 색상 | 코드 |
|------|------|------|
| 정점 | 청록색 | #4ECDC4 |
| 정점 외곽선 | 어두운 회색 | #2C3E50 |
| 삼각형 선 | 빨강 | #FF6B6B |
| 외곽선 | 검정 | #2C3E50 |
| 정점 레이블 | 검정 | #2C3E50 |
| 삼각형 레이블 | 빨강 | #FF6B6B |

## 추가 기능 아이디어

### 1. 정점 정보 표시
마우스를 정점에 올리면 상세 정보 표시:
- 정점 번호
- 좌표 (x, y)
- 인접 정점

### 2. 삼각형 정보 표시
삼각형을 클릭하면:
- 삼각형 번호
- 3개 정점 번호
- 면적
- 각도

### 3. 통계 패널
실시간 통계 표시:
- FPS
- 메쉬 수
- 총 정점 수
- 총 삼각형 수
- 메모리 사용량

### 4. 정점 이동
와이어프레임 모드에서 정점을 드래그하여 메쉬 변형

### 5. 삼각형 하이라이트
특정 삼각형을 선택하여 강조 표시

## 문제 해결

### Q: 와이어프레임이 너무 복잡해서 보기 어려워요
**A:** Bezier 세그먼트 수를 줄이세요 (10 → 5)

### Q: 정점 번호가 겹쳐서 읽을 수 없어요
**A:** 도형 크기를 키우거나, 폰트 크기를 조정하세요

### Q: 삼각형이 폴리곤 밖으로 나가요
**A:** 오목 다각형인 경우 Fan Triangulation의 한계입니다. Ear Clipping 알고리즘으로 업그레이드하세요.

### Q: 와이어프레임 모드에서 절단이 안돼요
**A:** 절단은 정상 작동합니다. 와이어프레임을 끄고 다시 켜면 새로운 메쉬 구조를 볼 수 있습니다.

## 기술적 세부사항

### Canvas 좌표계
```
(0,0) ────────→ X
  │
  │
  │
  ↓
  Y
```

### 정점 저장 형식
```javascript
vertices = [
    { x: 100, y: 200 },  // V0
    { x: 150, y: 250 },  // V1
    { x: 200, y: 200 },  // V2
    // ...
]
```

### 삼각형 저장 형식
```javascript
triangles = [
    [  // T0
        { x: 100, y: 200 },  // V0
        { x: 150, y: 250 },  // V1
        { x: 200, y: 200 }   // V2
    ],
    // ...
]
```

## 참고 자료

- [Polygon Triangulation (Wikipedia)](https://en.wikipedia.org/wiki/Polygon_triangulation)
- [Ear Clipping Algorithm](https://www.geometrictools.com/Documentation/TriangulationByEarClipping.pdf)
- [Delaunay Triangulation](https://en.wikipedia.org/wiki/Delaunay_triangulation)
- [Canvas API](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API)

